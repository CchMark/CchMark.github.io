<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.115.1"><meta http-equiv=content-security-policy content="
  default-src 'self';
  script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdnjs.cloudflare.com;
  style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com;
  font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
  img-src 'self' data: https:;
  connect-src 'self';
  media-src 'self';
  object-src 'none';
  base-uri 'self';
  form-action 'self';
  upgrade-insecure-requests;
"><meta http-equiv=strict-transport-security content="max-age=31536000; includeSubDomains; preload"><meta http-equiv=x-content-type-options content="nosniff"><meta http-equiv=x-xss-protection content="1; mode=block"><meta name=referrer content="strict-origin-when-cross-origin"><meta http-equiv=permissions-policy content="
  camera=(),
  microphone=(),
  geolocation=(),
  payment=(),
  usb=(),
  magnetometer=(),
  gyroscope=(),
  accelerometer=(),
  ambient-light-sensor=(),
  autoplay=(),
  battery=(),
  display-capture=(),
  document-domain=(),
  encrypted-media=(),
  fullscreen=(self),
  picture-in-picture=()
"><script>location.protocol!=="https:"&&location.hostname!=="localhost"&&location.replace("https:"+window.location.href.substring(window.location.protocol.length))</script><title>2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜ &#183; The Mark Chang Life</title><meta name=description content><meta itemprop=name content="2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜"><meta itemprop=description content="âœ… é—œæ³¨é»åˆ†é›¢ SOPï¼ˆé©ç”¨æ–¼æ‰€æœ‰å¾Œç«¯æ‡‰ç”¨ï¼‰ æ­¥é©Ÿä¸€ï¼šå…ˆå•è‡ªå·±ã€Œé€™æ®µé‚è¼¯åœ¨åšä»€éº¼ï¼Ÿã€ é€™æ˜¯æ ¸å¿ƒåˆ¤æ–·é»ã€‚ä½ æœƒç™¼ç¾å¤§å¤šæ•¸é‚è¼¯å±¬æ–¼ä»¥ä¸‹ 3 ç¨®è²¬ä»»ä¹‹ä¸€ï¼š
é¡å‹ èªªæ˜ å°æ‡‰å±¤ æµç¨‹æ§åˆ¶ èª¿ç”¨å“ªäº›å‹•ä½œã€é †åºã€æ¢ä»¶ Mainã€JobTaskã€Controller å•†æ¥­é‚è¼¯ æ€éº¼è™•ç†è³‡æ–™ã€å»é‡ã€åˆä½µã€è½‰æ› Service è³‡æ–™å­˜å– è·Ÿ DBã€FTPã€API çš„æºé€š Repository å±•ç¤ºèˆ‡åŒ¯å‡º Excelã€CSVã€HTML å›å‚³ç­‰ ExportService / ViewModel å·¥å…·èˆ‡å…±ç”¨åŠŸèƒ½ æ¸…æ–‡å­—ã€è¨ˆç®—æ¬„ä½ã€è½‰æ ¼å¼ Helper æˆ– Utils ğŸ“Œ æŠ€å·§ I/O é—œæ³¨é»ï¼šçœ‹åˆ° SqlConnectionã€File."><meta itemprop=datePublished content="2025-05-07T20:06:29+08:00"><meta itemprop=dateModified content="2025-05-07T20:06:29+08:00"><meta itemprop=wordCount content="250"><meta itemprop=keywords content="ç­†è¨˜,"><meta name=twitter:card content="summary"><meta name=twitter:title content="2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜"><meta name=twitter:description content="âœ… é—œæ³¨é»åˆ†é›¢ SOPï¼ˆé©ç”¨æ–¼æ‰€æœ‰å¾Œç«¯æ‡‰ç”¨ï¼‰ æ­¥é©Ÿä¸€ï¼šå…ˆå•è‡ªå·±ã€Œé€™æ®µé‚è¼¯åœ¨åšä»€éº¼ï¼Ÿã€ é€™æ˜¯æ ¸å¿ƒåˆ¤æ–·é»ã€‚ä½ æœƒç™¼ç¾å¤§å¤šæ•¸é‚è¼¯å±¬æ–¼ä»¥ä¸‹ 3 ç¨®è²¬ä»»ä¹‹ä¸€ï¼š
é¡å‹ èªªæ˜ å°æ‡‰å±¤ æµç¨‹æ§åˆ¶ èª¿ç”¨å“ªäº›å‹•ä½œã€é †åºã€æ¢ä»¶ Mainã€JobTaskã€Controller å•†æ¥­é‚è¼¯ æ€éº¼è™•ç†è³‡æ–™ã€å»é‡ã€åˆä½µã€è½‰æ› Service è³‡æ–™å­˜å– è·Ÿ DBã€FTPã€API çš„æºé€š Repository å±•ç¤ºèˆ‡åŒ¯å‡º Excelã€CSVã€HTML å›å‚³ç­‰ ExportService / ViewModel å·¥å…·èˆ‡å…±ç”¨åŠŸèƒ½ æ¸…æ–‡å­—ã€è¨ˆç®—æ¬„ä½ã€è½‰æ ¼å¼ Helper æˆ– Utils ğŸ“Œ æŠ€å·§ I/O é—œæ³¨é»ï¼šçœ‹åˆ° SqlConnectionã€File."><meta property="og:title" content="2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜"><meta property="og:description" content="âœ… é—œæ³¨é»åˆ†é›¢ SOPï¼ˆé©ç”¨æ–¼æ‰€æœ‰å¾Œç«¯æ‡‰ç”¨ï¼‰ æ­¥é©Ÿä¸€ï¼šå…ˆå•è‡ªå·±ã€Œé€™æ®µé‚è¼¯åœ¨åšä»€éº¼ï¼Ÿã€ é€™æ˜¯æ ¸å¿ƒåˆ¤æ–·é»ã€‚ä½ æœƒç™¼ç¾å¤§å¤šæ•¸é‚è¼¯å±¬æ–¼ä»¥ä¸‹ 3 ç¨®è²¬ä»»ä¹‹ä¸€ï¼š
é¡å‹ èªªæ˜ å°æ‡‰å±¤ æµç¨‹æ§åˆ¶ èª¿ç”¨å“ªäº›å‹•ä½œã€é †åºã€æ¢ä»¶ Mainã€JobTaskã€Controller å•†æ¥­é‚è¼¯ æ€éº¼è™•ç†è³‡æ–™ã€å»é‡ã€åˆä½µã€è½‰æ› Service è³‡æ–™å­˜å– è·Ÿ DBã€FTPã€API çš„æºé€š Repository å±•ç¤ºèˆ‡åŒ¯å‡º Excelã€CSVã€HTML å›å‚³ç­‰ ExportService / ViewModel å·¥å…·èˆ‡å…±ç”¨åŠŸèƒ½ æ¸…æ–‡å­—ã€è¨ˆç®—æ¬„ä½ã€è½‰æ ¼å¼ Helper æˆ– Utils ğŸ“Œ æŠ€å·§ I/O é—œæ³¨é»ï¼šçœ‹åˆ° SqlConnectionã€File."><meta property="og:type" content="article"><meta property="og:url" content="https://cchmark.github.io/posts/2025-05-07-post/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-07T20:06:29+08:00"><meta property="article:modified_time" content="2025-05-07T20:06:29+08:00"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://cchmark.github.io#author","name":"Mark_Chang","image":{"@type":"ImageObject","url":"https://cchmark.github.io/images/black.jpg"},"description":"learn by doing, and by falling over."},{"@type":"WebSite","@id":"https://cchmark.github.io#website","url":"https://cchmark.github.io","name":"The Mark Chang Life","description":"learn by doing, and by falling over.","publisher":{"@id":"https://cchmark.github.io#author"},"inLanguage":"en"},{"@type":"WebPage","@id":"https://cchmark.github.io/posts/2025-05-07-post/#webpage","url":"https://cchmark.github.io/posts/2025-05-07-post/","name":"2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜","isPartOf":{"@id":"https://cchmark.github.io#website"},"about":{"@id":"https://cchmark.github.io#author"},"datePublished":"2025-05-07T20:06:29+08:00","dateModified":"2025-05-07T20:06:29+08:00","description":"âœ… é—œæ³¨é»åˆ†é›¢ SOPï¼ˆé©ç”¨æ–¼æ‰€æœ‰å¾Œç«¯æ‡‰ç”¨ï¼‰ æ­¥é©Ÿä¸€ï¼šå…ˆå•è‡ªå·±ã€Œé€™æ®µé‚è¼¯åœ¨åšä»€éº¼ï¼Ÿã€ é€™æ˜¯æ ¸å¿ƒåˆ¤æ–·é»ã€‚ä½ æœƒç™¼ç¾å¤§å¤šæ•¸é‚è¼¯å±¬æ–¼ä»¥ä¸‹ 3 ç¨®è²¬ä»»ä¹‹ä¸€ï¼š\né¡å‹ èªªæ˜ å°æ‡‰å±¤ æµç¨‹æ§åˆ¶ èª¿ç”¨å“ªäº›å‹•ä½œã€é †åºã€æ¢ä»¶ Mainã€JobTaskã€Controller å•†æ¥­é‚è¼¯ æ€éº¼è™•ç†è³‡æ–™ã€å»é‡ã€åˆä½µã€è½‰æ› Service è³‡æ–™å­˜å– è·Ÿ DBã€FTPã€API çš„æºé€š Repository å±•ç¤ºèˆ‡åŒ¯å‡º Excelã€CSVã€HTML å›å‚³ç­‰ ExportService / ViewModel å·¥å…·èˆ‡å…±ç”¨åŠŸèƒ½ æ¸…æ–‡å­—ã€è¨ˆç®—æ¬„ä½ã€è½‰æ ¼å¼ Helper æˆ– Utils ğŸ“Œ æŠ€å·§ I/O é—œæ³¨é»ï¼šçœ‹åˆ° SqlConnectionã€File.","inLanguage":"en","potentialAction":[{"@type":"ReadAction","target":["https://cchmark.github.io/posts/2025-05-07-post/"]}]},{"@type":"Article","isPartOf":{"@id":"https://cchmark.github.io/posts/2025-05-07-post/#webpage"},"mainEntityOfPage":{"@id":"https://cchmark.github.io/posts/2025-05-07-post/#webpage"},"headline":"2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜","datePublished":"2025-05-07T20:06:29+08:00","dateModified":"2025-05-07T20:06:29+08:00","publisher":{"@id":"https://cchmark.github.io#author"},"keywords":["ç­†è¨˜"],"articleSection":["ç­†è¨˜"],"inLanguage":"en","author":{"@type":"Person","name":null},"potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://cchmark.github.io/posts/2025-05-07-post/#comments"]}]}]}</script><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=preconnect href=https://fonts.googleapis.com crossorigin><style>*{box-sizing:border-box}body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,sans-serif;line-height:1.6;color:#333}.content{max-width:800px;margin:0 auto;padding:1rem}.sidebar{position:fixed;top:0;left:0;bottom:0;width:14rem;padding:2rem 1rem;background-color:#202020;transform:translateX(-14rem);transition:transform .3s ease-in-out}.sidebar-about h1{color:#fff;margin-top:0;font-size:1.25rem}img{max-width:100%;height:auto;display:block}.responsive-img{max-width:100%;height:auto;display:block;margin:0 auto;object-fit:contain;object-position:center}.img-container{position:relative;overflow:hidden;max-width:100%;height:auto}.img-container img{width:100%;height:100%;object-fit:contain;object-position:center}.loading{opacity:0;transition:opacity .3s ease-in-out;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0 50%,#f0f0f0 75%);background-size:200% 100%;animation:loading-shimmer 1.5s infinite}.loaded{opacity:1}@keyframes loading-shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}@media(min-width:48em){.sidebar{position:fixed;transform:translateX(0)}.content{margin-left:14rem;max-width:32rem}}@media(prefers-color-scheme:dark){body{background-color:#1a1a1a;color:#e0e0e0}.loading{background:linear-gradient(90deg,#2a2a2a 25%,#3a3a3a 50%,#2a2a2a 75%);background-size:200% 100%}}@media(prefers-reduced-motion:reduce){.loading{animation:none}.sidebar{transition:none}*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}</style><link rel=preload as=style href=https://cchmark.github.io/css/poole.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/poole.css></noscript><link rel=preload as=style href=https://cchmark.github.io/css/hyde.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/hyde.css></noscript><link rel=preload as=style href=https://cchmark.github.io/css/responsive-images.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/responsive-images.css></noscript><link rel=preload as=style href=https://cchmark.github.io/css/heading-fix.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/heading-fix.css></noscript><link rel=preload as=style href=https://cchmark.github.io/css/local-icons.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/local-icons.css></noscript><link rel=preload as=style href=https://cchmark.github.io/css/local-icons.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/local-icons.css></noscript><link type=text/css rel=stylesheet href=https://cchmark.github.io/css/print.css media=print><link rel=preload as=style href=https://cchmark.github.io/css/hyde.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/hyde.css></noscript><link rel=preload as=style href=https://cchmark.github.io/css/responsive-images.css onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cchmark.github.io/css/responsive-images.css></noscript><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&family=Roboto:wght@400;700&display=swap" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&family=Roboto:wght@400;700&display=swap"></noscript><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://cchmark.github.io/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://cchmark.github.io/favicon.png></head><body><aside class=sidebar><div class=container><div class=sidebar-about><div class=author-image><a href=https://cchmark.github.io><img src=https://cchmark.github.io/images/black.jpg class="img-circle img-headshot center" alt="Profile Picture" loading=lazy></a></div><h1>The Mark Chang Life</h1><p class=lead>learn by doing, and by falling over.</p></div><nav><ul class=sidebar-nav><li><a href=https://cchmark.github.io>Home</a></li><li><a href=https://cchmark.github.io/archives/>Archives</a></li><li><a href=https://cchmark.github.io/about/>About</a></li></ul></nav><section class=social-icons><a href=mailto:markchangstart2022@gmail.com rel=me title=E-Mail target=_blank><span class="icon icon-email" aria-label=E-Mail></span></a></section></div></aside><main class="content container"><div class=post><h1 class=title>2025 05 07 é—œæ³¨é»åˆ†é›¢æ‡‰ç”¨ç­†è¨˜</h1><div class=post-date><time datetime=2025-05-07T20:06:29+0800>May 7, 2025</time> <span class=readtime>&#183; 2 min read</span></div><div><h2 id=-é—œæ³¨é»åˆ†é›¢-sopé©ç”¨æ–¼æ‰€æœ‰å¾Œç«¯æ‡‰ç”¨>âœ… é—œæ³¨é»åˆ†é›¢ SOPï¼ˆé©ç”¨æ–¼æ‰€æœ‰å¾Œç«¯æ‡‰ç”¨ï¼‰</h2><h3 id=æ­¥é©Ÿä¸€å…ˆå•è‡ªå·±é€™æ®µé‚è¼¯åœ¨åšä»€éº¼>æ­¥é©Ÿä¸€ï¼šå…ˆå•è‡ªå·±ã€Œé€™æ®µé‚è¼¯åœ¨åšä»€éº¼ï¼Ÿã€</h3><p>é€™æ˜¯æ ¸å¿ƒåˆ¤æ–·é»ã€‚ä½ æœƒç™¼ç¾å¤§å¤šæ•¸é‚è¼¯å±¬æ–¼ä»¥ä¸‹ 3 ç¨®è²¬ä»»ä¹‹ä¸€ï¼š</p><table><thead><tr><th>é¡å‹</th><th>èªªæ˜</th><th>å°æ‡‰å±¤</th></tr></thead><tbody><tr><td><strong>æµç¨‹æ§åˆ¶</strong></td><td>èª¿ç”¨å“ªäº›å‹•ä½œã€é †åºã€æ¢ä»¶</td><td>Mainã€JobTaskã€Controller</td></tr><tr><td><strong>å•†æ¥­é‚è¼¯</strong></td><td>æ€éº¼è™•ç†è³‡æ–™ã€å»é‡ã€åˆä½µã€è½‰æ›</td><td>Service</td></tr><tr><td><strong>è³‡æ–™å­˜å–</strong></td><td>è·Ÿ DBã€FTPã€API çš„æºé€š</td><td>Repository</td></tr><tr><td><strong>å±•ç¤ºèˆ‡åŒ¯å‡º</strong></td><td>Excelã€CSVã€HTML å›å‚³ç­‰</td><td>ExportService / ViewModel</td></tr><tr><td><strong>å·¥å…·èˆ‡å…±ç”¨åŠŸèƒ½</strong></td><td>æ¸…æ–‡å­—ã€è¨ˆç®—æ¬„ä½ã€è½‰æ ¼å¼</td><td>Helper æˆ– Utils</td></tr></tbody></table><h4 id=-æŠ€å·§>ğŸ“Œ æŠ€å·§</h4><ul><li><strong>I/O é—œæ³¨é»</strong>ï¼šçœ‹åˆ° <code>SqlConnection</code>ã€<code>File.WriteAllText</code>ã€<code>client.Send()</code> â†’ æ”¾ <code>Repository</code> æˆ– <code>ExportService</code>ã€‚</li><li><strong>è³‡æ–™é‚è¼¯</strong>ï¼šçœ‹åˆ° <code>GroupBy</code>ã€<code>Select</code>ã€<code>Join</code> â†’ æ”¾ <code>Service</code>ã€‚</li><li><strong>æµç¨‹æ§åˆ¶</strong>ï¼šçœ‹åˆ° <code>Execute()</code>ã€<code>Run()</code>ã€<code>DoSync()</code> â†’ æ”¾ <code>Task</code>ã€‚</li></ul><hr><h3 id=æ­¥é©ŸäºŒæ‹†åˆ†è²¬ä»»--æ”¾é€²å°ˆå±¬æ¨¡çµ„>æ­¥é©ŸäºŒï¼šæ‹†åˆ†è²¬ä»» â†’ æ”¾é€²å°ˆå±¬æ¨¡çµ„</h3><table><thead><tr><th>è²¬ä»»</th><th>ç¯„ä¾‹åˆ¤æ–·èªå¥</th><th>è©²æ”¾å“ªè£¡</th></tr></thead><tbody><tr><td><strong>è™•ç†æµç¨‹</strong></td><td><code>task.Execute()</code> / <code>controller.Post()</code></td><td>JobTask / Controller</td></tr><tr><td><strong>æŸ¥è³‡æ–™è¡¨</strong></td><td><code>SELECT * FROM ...</code> / <code>Query&lt;T>()</code></td><td>Repository</td></tr><tr><td><strong>å•†æ¥­åˆ¤æ–·</strong></td><td><code>if (data.Count > 0)</code> / <code>join/group</code></td><td>Service</td></tr><tr><td><strong>æ ¼å¼è½‰æ›</strong></td><td><code>string.Join()</code> / <code>Regex.Replace</code></td><td>Helper</td></tr><tr><td><strong>åŒ¯å‡º Excel</strong></td><td><code>ExcelPackage.SaveAs()</code></td><td>ExportService</td></tr></tbody></table><hr><h3 id=æ­¥é©Ÿä¸‰è®“æµç¨‹å‘¼å«æœå‹™å‘¼å«å­˜å–>æ­¥é©Ÿä¸‰ï¼šè®“ã€Œæµç¨‹ã€å‘¼å«ã€Œæœå‹™ã€å‘¼å«ã€Œå­˜å–ã€</h3><h4 id=-éŒ¯èª¤å¯«æ³•>âŒ éŒ¯èª¤å¯«æ³•ï¼š</h4><p>æµç¨‹ç›´æ¥é–‹ <code>SqlConnection</code> æ’ˆè³‡æ–™ + åšé‚è¼¯ + è¼¸å‡º Excelã€‚</p><h4 id=-æ­£ç¢ºæ‹†åˆ†>âœ… æ­£ç¢ºæ‹†åˆ†ï¼š</h4><p><code>Main/JobTask --> ProductService --> ProductRepository --> ExportService</code></p><hr><h3 id=æ­¥é©Ÿå››å‘½åè¦å¹«åŠ©è‡ªæˆ‘å®šä½>æ­¥é©Ÿå››ï¼šå‘½åè¦å¹«åŠ©ã€Œè‡ªæˆ‘å®šä½ã€</h3><ul><li><strong>XXXRepository</strong> â†’ ä¸€çœ‹å°±çŸ¥é“æ˜¯ DB æ“ä½œã€‚</li><li><strong>XXXService</strong> â†’ å°ˆæ³¨åšè³‡æ–™è™•ç†èˆ‡æµç¨‹è¦å‰‡ã€‚</li><li><strong>XXXDto</strong> â†’ æ˜¯è³‡æ–™å‚³è¼¸ç”¨ï¼Œæ²’æœ‰è¡Œç‚ºé‚è¼¯ã€‚</li><li><strong>XXXHelper</strong> â†’ æ˜¯å·¥å…·ï¼Œä¸ä¾è³´è³‡æ–™æµç¨‹ç‹€æ…‹ã€‚</li></ul><h4 id=-æ‡¶äººæŠ€å·§>ğŸ¯ æ‡¶äººæŠ€å·§</h4><p>å•è‡ªå·±ï¼šã€Œæˆ‘ä»¥å¾Œæœƒä¸æœƒæƒ³å–®ç¨é‡ç”¨é€™æ®µï¼Ÿæ¸¬è©¦å®ƒï¼Ÿå–®ç¨æ›è³‡æ–™ä¾†æºï¼Ÿã€</p><ul><li>å¦‚æœæœƒï¼Œé‚£å°±æ‡‰è©²æŠŠå®ƒæ‹†åˆ°ç¨ç«‹æ¨¡çµ„ï¼ˆRepositoryã€Serviceã€Export&mldr;ï¼‰ã€‚</li></ul><hr><h2 id=-æœ€å¸¸ç”¨-4-å±¤ç°¡æ˜“å°ç…§è¡¨çµ¦ä½ æ¯æ¬¡åš-job-æ™‚åƒè€ƒ>ğŸ“Œ æœ€å¸¸ç”¨ 4 å±¤ç°¡æ˜“å°ç…§è¡¨ï¼ˆçµ¦ä½ æ¯æ¬¡åš Job æ™‚åƒè€ƒï¼‰</h2><table><thead><tr><th>å±¤ç´š</th><th>åŠŸèƒ½æè¿°</th><th>ç¯„ä¾‹é¡åˆ¥</th></tr></thead><tbody><tr><td><strong>UI/æµç¨‹å±¤</strong></td><td>æ§åˆ¶åŸ·è¡Œé †åºã€è™•ç†è¼¸å…¥åƒæ•¸</td><td>Mainã€ProductMainTask</td></tr><tr><td><strong>Serviceå±¤</strong></td><td>è™•ç†å•†æ¥­é‚è¼¯ã€è³‡æ–™åˆä½µã€åˆ¤æ–·é‚è¼¯</td><td>ProductService, SyncService</td></tr><tr><td><strong>Repositoryå±¤</strong></td><td>æ’ˆè³‡æ–™ã€å­˜è³‡æ–™</td><td>ProductRepository</td></tr><tr><td><strong>Outputå±¤</strong></td><td>åŒ¯å‡º Excel/æª”æ¡ˆã€æ¨é€å¤–éƒ¨æœå‹™</td><td>ExportService, ApiPoster</td></tr></tbody></table><hr><h2 id=æ¶æ§‹åœ–é—œæ³¨é»åˆ†é›¢çš„åˆ†å±¤è¨­è¨ˆ>æ¶æ§‹åœ–ï¼šé—œæ³¨é»åˆ†é›¢çš„åˆ†å±¤è¨­è¨ˆ</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>ProductJob/
</span></span><span style=display:flex><span>â”œâ”€â”€ Program.cs â† Job å…¥å£é»ï¼Œå•Ÿå‹•æ•´å€‹æµç¨‹
</span></span><span style=display:flex><span>â”œâ”€â”€ AppCode/
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ ProductMainTask.cs â† æ§åˆ¶æ•´é«”æµç¨‹çš„ä¸»æ§é¡åˆ¥
</span></span><span style=display:flex><span>â”œâ”€â”€ Services/ â† å•†æ¥­é‚è¼¯èˆ‡æµç¨‹è™•ç†
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ ProductService.cs
</span></span><span style=display:flex><span>â”œâ”€â”€ Repositories/ â† è³‡æ–™å­˜å–å±¤ (Dapper SQL)
</span></span><span style=display:flex><span>â”‚   â”œâ”€â”€ ProductRepository.cs
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ ItemRepository.cs
</span></span><span style=display:flex><span>â”œâ”€â”€ Export/ â† è³‡æ–™åŒ¯å‡ºè™•ç†
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ ExportService.cs
</span></span><span style=display:flex><span>â”œâ”€â”€ DTOs/ â† è³‡æ–™å‚³è¼¸ç‰©ä»¶
</span></span><span style=display:flex><span>â”‚   â””â”€â”€ ProductMainDto.cs
</span></span><span style=display:flex><span>â””â”€â”€ Mapping/ â† AutoMapper è¨­å®š
</span></span><span style=display:flex><span>    â””â”€â”€ MappingProfile.cs
</span></span></code></pre></div><hr><h2 id=-è©³ç´°è§£èªªé—œæ³¨é»åˆ†é›¢çš„æ€è€ƒæ–¹å¼>ğŸ” è©³ç´°è§£èªªï¼šé—œæ³¨é»åˆ†é›¢çš„æ€è€ƒæ–¹å¼</h2><h3 id=1-programcså•Ÿå‹•å±¤>1. <strong>Program.csï¼ˆå•Ÿå‹•å±¤ï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šä½œç‚ºæ‡‰ç”¨ç¨‹å¼çš„å…¥å£é»ï¼Œè² è²¬åˆå§‹åŒ–å¿…è¦çš„æœå‹™å’Œå•Ÿå‹•ä¸»æµç¨‹ã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šä¿æŒå•Ÿå‹•é‚è¼¯çš„ç°¡æ½”ï¼Œé¿å…æ··å…¥æ¥­å‹™é‚è¼¯ï¼Œæ–¹ä¾¿æ—¥å¾Œçš„æ¸¬è©¦å’Œç¶­è­·ã€‚</li></ul><h3 id=2-appcodeproductmaintaskcsæµç¨‹æ§åˆ¶å±¤>2. <strong>AppCode/ProductMainTask.csï¼ˆæµç¨‹æ§åˆ¶å±¤ï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šæ§åˆ¶æ•´å€‹è³‡æ–™åŒæ­¥çš„æµç¨‹ï¼Œèª¿ç”¨å„å€‹æœå‹™å®Œæˆç‰¹å®šä»»å‹™ã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šå°‡æµç¨‹æ§åˆ¶èˆ‡å…·é«”çš„æ¥­å‹™é‚è¼¯åˆ†é›¢ï¼Œä½¿æµç¨‹æ›´æ¸…æ™°ï¼Œæ¥­å‹™é‚è¼¯æ›´å°ˆæ³¨ã€‚</li></ul><h3 id=3-servicesproductservicecså•†æ¥­é‚è¼¯å±¤>3. <strong>Services/ProductService.csï¼ˆå•†æ¥­é‚è¼¯å±¤ï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šå¯¦ç¾å…·é«”çš„æ¥­å‹™é‚è¼¯ï¼Œå¦‚è³‡æ–™çš„åˆä½µã€å»é‡ç­‰ã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šå°‡æ¥­å‹™é‚è¼¯é›†ä¸­ç®¡ç†ï¼Œä¾¿æ–¼æ¸¬è©¦å’Œé‡ç”¨ï¼Œä¸¦èˆ‡è³‡æ–™å­˜å–å’Œæµç¨‹æ§åˆ¶åˆ†é›¢ã€‚</li></ul><h3 id=4-repositoriesè³‡æ–™å­˜å–å±¤>4. <strong>Repositories/ï¼ˆè³‡æ–™å­˜å–å±¤ï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šè² è²¬èˆ‡è³‡æ–™åº«çš„äº’å‹•ï¼ŒåŸ·è¡Œ SQL æŸ¥è©¢å’Œå‘½ä»¤ã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šå°‡è³‡æ–™å­˜å–èˆ‡æ¥­å‹™é‚è¼¯åˆ†é›¢ï¼Œä¾¿æ–¼ç®¡ç†è³‡æ–™å­˜å–çš„è®Šæ›´ï¼Œä¸¦æé«˜æ¸¬è©¦çš„éˆæ´»æ€§ã€‚</li></ul><h3 id=5-exportexportservicecsåŒ¯å‡ºå±¤>5. <strong>Export/ExportService.csï¼ˆåŒ¯å‡ºå±¤ï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šè™•ç†è³‡æ–™çš„åŒ¯å‡ºåŠŸèƒ½ï¼Œå¦‚å°‡è³‡æ–™åŒ¯å‡ºç‚º Excel æª”æ¡ˆã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šå°‡åŒ¯å‡ºåŠŸèƒ½ç¨ç«‹ï¼Œä¾¿æ–¼é‡ç”¨å’Œç¶­è­·ï¼Œä¸¦èˆ‡æ¥­å‹™é‚è¼¯å’Œæµç¨‹æ§åˆ¶åˆ†é›¢ã€‚</li></ul><h3 id=6-dtosè³‡æ–™å‚³è¼¸ç‰©ä»¶>6. <strong>DTOs/ï¼ˆè³‡æ–™å‚³è¼¸ç‰©ä»¶ï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šå®šç¾©è³‡æ–™åœ¨ä¸åŒå±¤ç´šä¹‹é–“å‚³éçš„çµæ§‹ã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šæ˜ç¢ºè³‡æ–™çš„çµæ§‹å’Œæ ¼å¼ï¼Œä¾¿æ–¼è³‡æ–™çš„è½‰æ›å’Œé©—è­‰ã€‚</li></ul><h3 id=7-mappingmappingprofilecsæ˜ å°„è¨­å®š>7. <strong>Mapping/MappingProfile.csï¼ˆæ˜ å°„è¨­å®šï¼‰</strong></h3><ul><li><strong>è²¬ä»»</strong>ï¼šè¨­å®š AutoMapper çš„æ˜ å°„è¦å‰‡ï¼Œå°‡ä¸åŒçš„è³‡æ–™æ¨¡å‹è½‰æ›ç‚º DTOã€‚</li><li><strong>ç‚ºä½•åˆ†é›¢</strong>ï¼šé›†ä¸­ç®¡ç†æ˜ å°„è¨­å®šï¼Œä¾¿æ–¼ç¶­è­·å’Œæ“´å±•ã€‚</li></ul><hr><h2 id=-å¦‚ä½•æ‡‰ç”¨é—œæ³¨é»åˆ†é›¢çš„æ€ç¶­>ğŸ§  å¦‚ä½•æ‡‰ç”¨é—œæ³¨é»åˆ†é›¢çš„æ€ç¶­</h2><ol><li><strong>è­˜åˆ¥ä¸åŒçš„è²¬ä»»</strong>ï¼šåˆ†æç¨‹å¼ç¢¼ä¸­ä¸åŒçš„åŠŸèƒ½å’Œè²¬ä»»ï¼Œå°‡å…¶åŠƒåˆ†ç‚ºä¸åŒçš„æ¨¡çµ„æˆ–å±¤ç´šã€‚</li><li><strong>å®šç¾©æ¸…æ™°çš„ä»‹é¢</strong>ï¼šç‚ºæ¯å€‹æ¨¡çµ„å®šç¾©æ¸…æ™°çš„ä»‹é¢ï¼Œç¢ºä¿æ¨¡çµ„ä¹‹é–“çš„äº’å‹•ç°¡æ½”æ˜ç¢ºã€‚</li><li><strong>ä¿æŒæ¨¡çµ„çš„ç¨ç«‹æ€§</strong>ï¼šç¢ºä¿æ¯å€‹æ¨¡çµ„å°ˆæ³¨æ–¼å…¶ç‰¹å®šçš„è²¬ä»»ï¼Œé¿å…æ¨¡çµ„ä¹‹é–“çš„éåº¦è€¦åˆã€‚</li><li><strong>ä¾¿æ–¼æ¸¬è©¦å’Œç¶­è­·</strong>ï¼šé€éåˆ†é›¢çš„æ¨¡çµ„è¨­è¨ˆï¼Œä½¿å¾—æ¯å€‹æ¨¡çµ„å¯ä»¥ç¨ç«‹æ¸¬è©¦å’Œç¶­è­·ï¼Œæé«˜æ•´é«”ç³»çµ±çš„ç©©å®šæ€§å’Œå¯æ“´å±•æ€§ã€‚</li></ol></div><div><ul class=tags><li><a href=https://cchmark.github.io/tags/%E7%AD%86%E8%A8%98/ class=tag-link>ç­†è¨˜</a></li></ul></div><div class=share-buttons><a class=mail-share-button href=mailto:markchangstart2022@gmail.com title="Share on EMail"><span class="icon icon-email" aria-label=Email></span></a></div><script>function payBlock(){let e=document.getElementById("pay");e.style.height=="0px"?e.style.height="360px":e.style.height="0px"}</script><div style=color:red;text-align:center;cursor:pointer;text-decoration:underline;font-size:24px onclick=payBlock()>å¦‚æœå–œæ­¡å¯ä»¥è«‹æˆ‘å–æ¯å’–å•¡ï¼Œé€™æ¨£æˆ‘æœƒæ›´æœ‰å‹•åŠ›å”·XDD</div><div id=pay style="margin-top:20px;text-align:center;overflow:hidden;height:0;transition:height .5s ease 0s"><div style=display:inline-block;width:200px><img src=https://cchmark.github.io/images/jkosPay.jpg border=0 alt=è¡—å£æ”¯ä»˜ loading=lazy><p style=font-size:20px>è¡—å£æ”¯ä»˜</p><p>è¡—å£å¸³è™Ÿ: 901526306</p></div></div><br></br><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var e=document,t=e.createElement("script");t.src="https://https-cchmark-github-io-1.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></main><footer><div><p>&copy; // ç•¶ DOM æº–å‚™å¥½æ™‚åˆå§‹åŒ–
if (document.readyState === 'loading') {
document.addEventListener('DOMContentLoaded', initPrivacyCounter);
} else {
initPrivacyCounter();
}
})();
</script>pyright }} 2025
<span id=privacy-pageview-counter><noscript>æ„Ÿè¬æ‚¨çš„è¨ªå•ï¼</noscript></span></p></div></footer><script>(function(){"use strict";function e(){const e=document.getElementById("privacy-pageview-counter");if(!e)return;const t="privacy-view-count";let n=parseInt(sessionStorage.getItem(t)||"0")+1;sessionStorage.setItem(t,n.toString()),e.innerHTML=`æœ¬æ¬¡è¨ªå•ç¬¬ <span style="color: #007cba;">${n}</span> é `}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()})()</script>//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><footer><div><p>&copy; Mark_Chang All rights reserved. 2025
<span id=busuanzi_container_site_uv>ç¸½ç€è¦½<span id=busuanzi_value_site_uv></span>æ¬¡</span></p></div></footer><script>(function(){"use strict";if(window.modernScriptLoader)return;window.modernScriptLoader=!0;function e(e,t,n=null){return new Promise((s,o)=>{const i=document.createElement("script");i.src=e,n&&(i.integrity=n,i.crossOrigin="anonymous"),i.onload=()=>{t&&t(),s()},i.onerror=()=>{console.error("Failed to load script:",e),o(new Error(`Script load failed: ${e}`))},document.head.appendChild(i)})}window.addEventListener("load",async function(){const t=["/js/jquery.min.js","/js/cookie-compliance.js","/js/performance.js","/js/analytics.js","/js/soho.js","/js/theme-toggle.js"];try{for(const n of t)await e(n),await new Promise(e=>setTimeout(e,50));console.log("âœ“ All essential scripts loaded successfully")}catch(e){console.warn("Script loading failed:",e.message)}})})()</script><script>window.addEventListener("load",async function(){try{if(window.modernScriptLoader){const e=function(e){return new Promise((t,n)=>{const s=document.createElement("script");s.src=e,s.onload=t,s.onerror=n,document.head.appendChild(s)})};await e("/js/soho.js")}}catch(e){console.warn("Custom script loading failed:",e)}})</script><script>window.addEventListener("load",async function(){try{if(window.modernScriptLoader){const e=function(e){return new Promise((t,n)=>{const s=document.createElement("script");s.src=e,s.onload=t,s.onerror=n,document.head.appendChild(s)})};await e("/js/performance.js")}}catch(e){console.warn("Custom script loading failed:",e)}})</script><script>window.addEventListener("load",async function(){try{if(window.modernScriptLoader){const e=function(e){return new Promise((t,n)=>{const s=document.createElement("script");s.src=e,s.onload=t,s.onerror=n,document.head.appendChild(s)})};await e("/js/analytics.js")}}catch(e){console.warn("Custom script loading failed:",e)}})</script></body></html>